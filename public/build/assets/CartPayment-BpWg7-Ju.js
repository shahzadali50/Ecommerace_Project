import{e as c,I as W,d as A,l as D,q as X,a as y,o as v,b as s,f as x,s as b,g as _,u as r,t as i,F as G,n as L,c as R,C as Q,r as P,w as u,m as Y,P as T,aH as K,ax as V,ay as O,v as Z,x as ee,aF as te}from"./app-Ma9SSVpW.js";import{_ as re}from"./UserLayout.vue_vue_type_script_setup_true_lang-C-RhsJd6.js";import{_ as ne}from"./Button.vue_vue_type_script_setup_true_lang-C4BKN-ah.js";import{L as N}from"./loader-circle-Cevmg_nE.js";import{S as se}from"./ShoppingCartOutlined-QkQbLLF8.js";import{S as ae}from"./ShoppingOutlined-BySwsbVE.js";import"./useFlashMessages-BJftgPRo.js";import"./LanguageSwitcher.vue_vue_type_script_setup_true_lang-WShoa_wZ.js";import"./createLucideIcon-Db22gBq7.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-792 72h752v120H136V232zm752 560H136V440h752v352zm-237-64h165c4.4 0 8-3.6 8-8v-72c0-4.4-3.6-8-8-8H651c-4.4 0-8 3.6-8 8v72c0 4.4 3.6 8 8 8z"}}]},name:"credit-card",theme:"outlined"};function I(o){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),t.forEach(function(a){ie(o,a,n[a])})}return o}function ie(o,e,n){return e in o?Object.defineProperty(o,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[e]=n,o}var E=function(e,n){var t=I({},e,n.attrs);return c(W,I({},t,{icon:oe}),null)};E.displayName="CreditCardOutlined";E.inheritAttrs=!1;var F="basil",le=function(e){return e===3?"v3":e},U="https://js.stripe.com",ce="".concat(U,"/").concat(F,"/stripe.js"),de=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ue=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var pe=function(e){return de.test(e)||ue.test(e)},me=function(){for(var e=document.querySelectorAll('script[src^="'.concat(U,'"]')),n=0;n<e.length;n++){var t=e[n];if(pe(t.src))return t}return null},$=function(e){var n="",t=document.createElement("script");t.src="".concat(ce).concat(n);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(t),t},fe=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:n})},S=null,C=null,j=null,ve=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},_e=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},he=function(e){return S!==null?S:(S=new Promise(function(n,t){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var a=me();if(!(a&&e)){if(!a)a=$(e);else if(a&&j!==null&&C!==null){var p;a.removeEventListener("load",j),a.removeEventListener("error",C),(p=a.parentNode)===null||p===void 0||p.removeChild(a),a=$(e)}}j=_e(n,t),C=ve(t),a.addEventListener("load",j),a.addEventListener("error",C)}catch(m){t(m);return}}),S.catch(function(n){return S=null,Promise.reject(n)}))},ye=function(e,n,t){if(e===null)return null;var a=n[0],p=a.match(/^pk_test/),m=le(e.version),l=F;p&&m!==l&&console.warn("Stripe.js@".concat(m," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var h=e.apply(void 0,n);return fe(h,t),h},w,q=!1,B=function(){return w||(w=he(null).catch(function(e){return w=null,Promise.reject(e)}),w)};Promise.resolve().then(function(){return B()}).catch(function(o){q||console.warn(o)});var xe=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];q=!0;var a=Date.now();return B().then(function(p){return ye(p,n,a)})};const be=["disabled"],ge={class:"text-sm text-gray-500 text-center mt-2"},Se={class:"font-medium text-gray-700"},we=A({__name:"StripePayment",setup(o){const{appContext:e}=D(),n=e.config.globalProperties.$t,t=X(!1),a=xe("pk_test_51RYMTBQMr3lJT8elm07sD9PQEnbaGh65DcosfmGAoyyJ70JDSARshmVUHwY31kPxzNGl2nqOvyuXQ6GPOyhb0Zqd00SnqRCf8y"),p=async()=>{var d;t.value=!0;const m=await a,h=await(await fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||""}})).json(),f=await(m==null?void 0:m.redirectToCheckout({sessionId:h.id}));f!=null&&f.error&&alert(f.error.message),t.value=!1};return(m,l)=>(v(),y(G,null,[s("button",{class:"w-full mt-4 flex items-center justify-center btn btn-dark",onClick:p,disabled:t.value},[t.value?(v(),x(r(N),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),t.value?b("",!0):(v(),x(r(E),{key:1,class:"mr-2"})),_(" "+i(r(n)("Pay with Card")),1)],8,be),s("p",ge,[_(i(r(n)("Secure payment powered by"))+" ",1),s("span",Se,i(r(n)("Stripe")),1),_(". "+i(r(n)("We do not store your card details.")),1)])],64))}}),Pe={class:"py-14"},Ce={class:"container mx-auto px-2 sm:px-4"},je={class:"text-center"},Oe={class:"text-gray-500 text-2xl"},Ee={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg"},ke={class:"list-disc list-inside text-red-600"},Le={key:0,class:"text-red-500"},Re={class:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6"},Te={class:""},Ve={class:"flex items-center"},Ie={class:"text-gray-500 text-sm ml-6"},$e={class:"text-2xl font-bold text-gray-900 mb-6"},Ae={class:"flex justify-between mb-4 border-b py-4"},De={class:""},Ge={class:"text-slate-500"},Ne={class:"flex justify-between mb-4 border-b py-4"},Fe={class:""},Ue={class:"text-slate-500"},qe={class:"flex justify-between mb-4"},Be={class:""},Je={class:"text-slate-500"},et=A({__name:"CartPayment",setup(o){const e=L(),{appContext:n}=D(),t=n.config.globalProperties.$t,a=R(()=>L().props.cart||[]),p=R(()=>a.value.reduce((f,d)=>f+d.total_price,0)),m=f=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:2}).format(f),l=Q({payment_method:""}),h=()=>{l.post(route("order.generate"),{onSuccess:()=>{l.reset()}})};return(f,d)=>{const J=P("a-alert"),z=P("a-radio"),H=P("a-radio-group"),M=P("a-button");return v(),x(re,null,{default:u(()=>{var k;return[c(r(Y),{title:r(t)("Payment")},null,8,["title"]),s("section",Pe,[s("div",Ce,[c(r(T),{href:f.route("cart.checkout"),class:"flex items-center mb-2"},{default:u(()=>[c(r(K)),_(i(r(t)("Back")),1)]),_:1},8,["href"]),(k=r(e).props.flash)!=null&&k.success?(v(),x(J,{key:0,class:"my-1",message:r(e).props.flash.success,type:"success","show-icon":""},null,8,["message"])):b("",!0),!a.value||a.value.length===0?(v(),x(r(V),{key:1,class:"py-10"},{default:u(()=>[c(r(O),{span:"24"},{default:u(()=>[s("div",je,[c(r(se),{class:"text-7xl text-gray-400 mb-4"}),s("h4",Oe,i(r(t)("Your cart is empty")),1),c(r(T),{href:f.route("home"),class:"inline-block mt-4"},{default:u(()=>[c(r(ne),null,{default:u(()=>[_(i(r(t)("Continue Shopping")),1)]),_:1})]),_:1},8,["href"])])]),_:1})]),_:1})):(v(),y("form",{key:2,class:"w-full",onSubmit:d[1]||(d[1]=Z(g=>h(),["prevent"]))},[Object.keys(r(l).errors).length>0?(v(),y("div",Ee,[s("ul",ke,[(v(!0),y(G,null,ee(Object.values(r(l).errors),g=>(v(),y("li",{key:g,class:"mb-1"},i(g),1))),128))])])):b("",!0),c(r(V),{class:"justify-between px-6"},{default:u(()=>[c(r(O),{xs:24,md:10,class:"mb-5 order-2 md:order-1"},{default:u(()=>[s("div",null,[d[3]||(d[3]=s("h1",{class:"text-5xl font-bold text-green-800 mb-6 flex items-center gap-2"}," 2. ",-1)),r(l).errors.payment_method?(v(),y("div",Le,i(r(l).errors.payment_method),1)):b("",!0),s("h1",Re,i(r(t)("Payment Method")),1),s("div",Te,[s("div",Ve,[c(H,{value:r(l).payment_method,"onUpdate:value":d[0]||(d[0]=g=>r(l).payment_method=g),class:"ml-2"},{default:u(()=>[c(z,{value:"Cash On Delivery"},{default:u(()=>[_(i(r(t)("Cash On Delivery")),1)]),_:1})]),_:1},8,["value"])]),s("p",Ie,i(r(t)("Pay with cash upon delivery.")),1)]),s("div",null,[c(M,{"html-type":"submit",class:"w-full btn-primary mt-5 flex items-center justify-center py-4",disabled:r(l).processing},te({default:u(()=>[r(l).processing?(v(),x(r(N),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),_(" "+i(r(t)("Place Order"))+" ",1)]),_:2},[r(l).processing?void 0:{name:"icon",fn:u(()=>[c(r(ae))]),key:"0"}]),1032,["disabled"]),d[2]||(d[2]=s("div",{class:"flex items-center my-6"},[s("div",{class:"flex-grow h-px bg-gray-300"}),s("span",{class:"mx-4 text-gray-600 font-medium"},"OR"),s("div",{class:"flex-grow h-px bg-gray-300"})],-1)),c(we)])])]),_:1}),c(r(O),{xs:24,md:10,class:"mb-5 order-1 md:order-2 p-4",style:{"box-shadow":"rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px"}},{default:u(()=>[s("div",null,[s("h1",$e,i(r(t)("Order Summary")),1)]),s("div",Ae,[s("span",De,i(r(t)("Subtotal")),1),s("span",Ge,i(m(p.value)),1)]),s("div",Ne,[s("span",Fe,i(r(t)("Shipping")),1),s("span",Ue,i(r(t)("Free Delivery")),1)]),s("div",qe,[s("span",Be,i(r(t)("Total"))+":",1),s("span",Je,i(m(p.value)),1)])]),_:1})]),_:1})],32))])])]}),_:1})}}});export{et as default};
