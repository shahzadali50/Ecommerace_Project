import{e as d,I as H,d as A,p as M,a as h,o as f,b as n,f as y,q as b,g as _,u as a,F as D,n as L,c as j,C as W,r as w,w as p,m as X,P as R,aH as Q,ax as T,ay as O,t as m,s as Y,v as K,aF as Z}from"./app-DhDN9clE.js";import{_ as ee}from"./UserLayout.vue_vue_type_script_setup_true_lang-B3KsgIcq.js";import{_ as te}from"./Button.vue_vue_type_script_setup_true_lang-CVpZQjM6.js";import{L as G}from"./loader-circle-DSpQXioM.js";import{S as re}from"./ShoppingCartOutlined-Bn7IPq_K.js";import{S as ne}from"./ShoppingOutlined-e5E75mek.js";import"./useFlashMessages-DN6iFL0s.js";import"./LanguageSwitcher.vue_vue_type_script_setup_true_lang-CSXaFYAK.js";import"./createLucideIcon-DbGtICm-.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-792 72h752v120H136V232zm752 560H136V440h752v352zm-237-64h165c4.4 0 8-3.6 8-8v-72c0-4.4-3.6-8-8-8H651c-4.4 0-8 3.6-8 8v72c0 4.4 3.6 8 8 8z"}}]},name:"credit-card",theme:"outlined"};function V(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),s.forEach(function(r){ae(o,r,t[r])})}return o}function ae(o,e,t){return e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}var E=function(e,t){var s=V({},e,t.attrs);return d(H,V({},s,{icon:se}),null)};E.displayName="CreditCardOutlined";E.inheritAttrs=!1;var N="basil",oe=function(e){return e===3?"v3":e},U="https://js.stripe.com",ie="".concat(U,"/").concat(N,"/stripe.js"),le=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ce=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var ue=function(e){return le.test(e)||ce.test(e)},de=function(){for(var e=document.querySelectorAll('script[src^="'.concat(U,'"]')),t=0;t<e.length;t++){var s=e[t];if(ue(s.src))return s}return null},I=function(e){var t="",s=document.createElement("script");s.src="".concat(ie).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(s),s},pe=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:t})},g=null,P=null,C=null,me=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},fe=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},ve=function(e){return g!==null?g:(g=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var r=de();if(!(r&&e)){if(!r)r=I(e);else if(r&&C!==null&&P!==null){var l;r.removeEventListener("load",C),r.removeEventListener("error",P),(l=r.parentNode)===null||l===void 0||l.removeChild(r),r=I(e)}}C=fe(t,s),P=me(s),r.addEventListener("load",C),r.addEventListener("error",P)}catch(i){s(i);return}}),g.catch(function(t){return g=null,Promise.reject(t)}))},_e=function(e,t,s){if(e===null)return null;var r=t[0],l=r.match(/^pk_test/),i=oe(e.version),v=N;l&&i!==v&&console.warn("Stripe.js@".concat(i," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(v,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,t);return pe(c,s),c},S,F=!1,q=function(){return S||(S=ve(null).catch(function(e){return S=null,Promise.reject(e)}),S)};Promise.resolve().then(function(){return q()}).catch(function(o){F||console.warn(o)});var he=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];F=!0;var r=Date.now();return q().then(function(l){return _e(l,t,r)})};const ye=["disabled"],be=A({__name:"StripePayment",setup(o){const e=M(!1),t=he("pk_test_51RYMTBQMr3lJT8elm07sD9PQEnbaGh65DcosfmGAoyyJ70JDSARshmVUHwY31kPxzNGl2nqOvyuXQ6GPOyhb0Zqd00SnqRCf8y"),s=async()=>{var c;e.value=!0;const r=await t,i=await(await fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.getAttribute("content"))||""}})).json(),v=await(r==null?void 0:r.redirectToCheckout({sessionId:i.id}));v!=null&&v.error&&alert(v.error.message),e.value=!1};return(r,l)=>(f(),h(D,null,[n("button",{class:"w-full mt-4 flex items-center justify-center btn btn-dark",onClick:s,disabled:e.value},[e.value?(f(),y(a(G),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),e.value?b("",!0):(f(),y(a(E),{key:1,class:"mr-2"})),l[0]||(l[0]=_(" Pay with Card "))],8,ye),l[1]||(l[1]=n("p",{class:"text-sm text-gray-500 text-center mt-2"},[_(" Secure payment powered by "),n("span",{class:"font-medium text-gray-700"},"Stripe"),_(". We do not store your card details. ")],-1))],64))}}),xe={class:"py-14"},ge={class:"container mx-auto px-2 sm:px-4"},Se={class:"text-center"},we={class:"text-gray-500 text-2xl"},Pe={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg"},Ce={class:"list-disc list-inside text-red-600"},je={key:0,class:"text-red-500"},Oe={class:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6"},Ee={class:""},ke={class:"flex items-center"},Le={class:"text-gray-500 text-sm ml-6"},Re={class:"flex justify-between mb-4 border-b py-4"},Te={class:""},Ve={class:"text-slate-500"},Ie={class:"flex justify-between mb-4 border-b py-4"},Ae={class:""},De={class:"text-slate-500"},Ge={class:"flex justify-between mb-4"},Ne={class:""},Ue={class:"text-slate-500"},Xe=A({__name:"CartPayment",setup(o){const e=L(),t=j(()=>{var c;return((c=e.props.translations)==null?void 0:c.cart_checkout)||{}}),s=j(()=>L().props.cart||[]),r=j(()=>s.value.reduce((c,u)=>c+u.total_price,0)),l=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR",minimumFractionDigits:2}).format(c),i=W({payment_method:""}),v=()=>{i.post(route("order.generate"),{onSuccess:()=>{i.reset()}})};return(c,u)=>{const B=w("a-alert"),J=w("a-radio"),$=w("a-radio-group"),z=w("a-button");return f(),y(ee,null,{default:p(()=>{var k;return[d(a(X),{title:"Payment"}),n("section",xe,[n("div",ge,[d(a(R),{href:c.route("cart.checkout"),class:"flex items-center mb-2"},{default:p(()=>[d(a(Q)),u[2]||(u[2]=_("Back"))]),_:1},8,["href"]),(k=a(e).props.flash)!=null&&k.success?(f(),y(B,{key:0,class:"my-1",message:a(e).props.flash.success,type:"success","show-icon":""},null,8,["message"])):b("",!0),!s.value||s.value.length===0?(f(),y(a(T),{key:1,class:"py-10"},{default:p(()=>[d(a(O),{span:"24"},{default:p(()=>[n("div",Se,[d(a(re),{class:"text-7xl text-gray-400 mb-4"}),n("h4",we,m(t.value.cart_empty||"Your cart is empty"),1),d(a(R),{href:c.route("home"),class:"inline-block mt-4"},{default:p(()=>[d(a(te),null,{default:p(()=>[_(m(t.value.continue_shopping||"Continue Shopping"),1)]),_:1})]),_:1},8,["href"])])]),_:1})]),_:1})):(f(),h("form",{key:2,class:"w-full",onSubmit:u[1]||(u[1]=Y(x=>v(),["prevent"]))},[Object.keys(a(i).errors).length>0?(f(),h("div",Pe,[n("ul",Ce,[(f(!0),h(D,null,K(Object.values(a(i).errors),x=>(f(),h("li",{key:x,class:"mb-1"},m(x),1))),128))])])):b("",!0),d(a(T),{class:"justify-between px-6"},{default:p(()=>[d(a(O),{xs:24,md:10,class:"mb-5 order-2 md:order-1"},{default:p(()=>[n("div",null,[u[5]||(u[5]=n("h1",{class:"text-5xl font-bold text-green-800 mb-6 flex items-center gap-2"}," 2. ",-1)),a(i).errors.payment_method?(f(),h("div",je,m(a(i).errors.payment_method),1)):b("",!0),n("h1",Oe,m(t.value.payment_method||"Payment Method"),1),n("div",Ee,[n("div",ke,[d($,{value:a(i).payment_method,"onUpdate:value":u[0]||(u[0]=x=>a(i).payment_method=x),class:"ml-2"},{default:p(()=>[d(J,{value:"Cash On Delivery"},{default:p(()=>[_(m(t.value.cash_on_delivery||"Cash On Delivery"),1)]),_:1})]),_:1},8,["value"])]),n("p",Le,m(t.value.pay_cash_on_delivery||"Pay with cash upon delivery."),1)]),n("div",null,[d(z,{"html-type":"submit",class:"w-full btn-primary mt-5 flex items-center justify-center py-4",disabled:a(i).processing},Z({default:p(()=>[a(i).processing?(f(),y(a(G),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),u[3]||(u[3]=_(" Place Order "))]),_:2},[a(i).processing?void 0:{name:"icon",fn:p(()=>[d(a(ne))]),key:"0"}]),1032,["disabled"]),u[4]||(u[4]=n("div",{class:"flex items-center my-6"},[n("div",{class:"flex-grow h-px bg-gray-300"}),n("span",{class:"mx-4 text-gray-600 font-medium"},"OR"),n("div",{class:"flex-grow h-px bg-gray-300"})],-1)),d(be)])])]),_:1}),d(a(O),{xs:24,md:10,class:"mb-5 order-1 md:order-2 p-4",style:{"box-shadow":"rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px"}},{default:p(()=>[u[6]||(u[6]=n("div",null,[n("h1",{class:"text-2xl font-bold text-gray-900 mb-6"}," Order Summary ")],-1)),n("div",Re,[n("span",Te,m(t.value.subtotal||"Subtotal"),1),n("span",Ve,m(l(r.value)),1)]),n("div",Ie,[n("span",Ae,m(t.value.shipping_charge||"Shipping"),1),n("span",De,m(t.value.free_delivery||"Free Delivery"),1)]),n("div",Ge,[n("span",Ne,m(t.value.total||"Total")+":",1),n("span",Ue,m(l(r.value)),1)])]),_:1})]),_:1})],32))])])]}),_:1})}}});export{Xe as default};
